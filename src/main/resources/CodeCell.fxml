<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.collections.FXCollections?>
<?import java.lang.String?>
<?import javafx.geometry.Insets?>
<?import org.kordamp.ikonli.javafx.FontIcon?>
<?import org.fxmisc.richtext.CodeArea?>

<HBox xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.vessel.frontendhelpers.CodeCellController"
      spacing="0" style="-fx-max-width: 1000px; -fx-pref-width: 1000px;" alignment="TOP_LEFT">

    <!-- Left blue bar that expands with cell -->
    <Region fx:id="leftBlueBar" style="-fx-min-width: 4px; -fx-pref-width: 4px; -fx-background-color: transparent;" HBox.hgrow="NEVER"/>

    <!-- Main cell content -->
    <VBox fx:id="root" spacing="5" style="-fx-max-width: 996px; -fx-pref-width: 996px;" alignment="CENTER" HBox.hgrow="ALWAYS">

        <padding>
            <Insets top="8" right="8" bottom="8" left="8"/>
        </padding>

        <!-- Execution count and active indicator bar -->
        <HBox spacing="8" alignment="CENTER_LEFT">
            <Label fx:id="executionCountLabel" text="" 
                   style="-fx-text-fill: #888888; -fx-font-size: 11px; -fx-font-family: 'Consolas', monospace; -fx-min-width: 60px;"/>
            <Region fx:id="activeIndicator" style="-fx-min-width: 4px; -fx-pref-width: 4px; -fx-min-height: 20px; -fx-background-color: transparent;"/>
        </HBox>

        <HBox spacing="8">
            <ChoiceBox fx:id="cellLanguage">
                <!-- Will be filled by initialize() in CodeCellController later-->
            </ChoiceBox>
            <Button fx:id="runBtn">
                <graphic>
                    <FontIcon iconLiteral="fas-play" iconSize="16" styleClass="font-icon" />
                </graphic>
                <tooltip>
                    <Tooltip text="Run this cell"/>
                </tooltip>
            </Button>
            <Button fx:id="deleteBtn">
                <graphic>
                    <FontIcon iconLiteral="fas-trash" iconSize="16" styleClass="font-icon" />
                </graphic>
                <tooltip>
                    <Tooltip text="Delete this cell"/>
                </tooltip>
            </Button>
            <Button fx:id="clearBtn">
                <graphic>
                    <FontIcon iconLiteral="fas-eraser" iconSize="16" styleClass="font-icon" />
                </graphic>
                <tooltip>
                    <Tooltip text="Clear this cell"/>
                </tooltip>
            </Button>
        </HBox>

        <CodeArea fx:id="codeArea" styleClass="code-area" VBox.vgrow="ALWAYS" />

        <VBox fx:id="outputBox" spacing="0" styleClass="output-area" minHeight="0" maxWidth="1000" visible="false">
            <!-- Output UI will be injected here dynamically by the controller -->
            <!-- Initially kept invisible until output injected-->
        </VBox>
    </VBox>
</HBox>